{% extends "base.html" %}
{% block title %}Gestisci Profilo{% endblock %}

{% block breadcrumbs %}
<li class="breadcrumb-item"><a href="{{ url_for('index') }}">Home</a></li>
<li class="breadcrumb-item active">Gestione Profili</li>
{% endblock %}

{% block content %}
<h2 class="mb-4">Profilo (aggancia Macro / Campi)</h2>

<form method="post">
	{{ form.hidden_tag() }}

	<!-- profilo ---------------------------------------------------- -->
	<div class="mb-4 col-md-4">
		{{ form.i_fk_profilo.label(class="form-label") }}
		{{ form.i_fk_profilo(class="form-select", id="sel-prof") }}
	</div>

	<!-- MACRO ------------------------------------------------------ -->
	<div class="mb-4">
		{{ form.macro.label(class="form-label") }}
		{{ form.macro(class="form-select chosen-select", multiple=true, data_placeholder="Seleziona macro…") }}
	</div>

	<!-- CAMPI ------------------------------------------------------ -->
	<div class="mb-4">
		{{ form.campi.label(class="form-label") }}
		{{ form.campi(class="form-select chosen-select", multiple=true, data_placeholder="Seleziona campi…") }}
	</div>

	<button type="submit" class="btn btn-success">{{ form.submit.label.text }}</button>
	<a href="{{ url_for('index') }}" class="btn btn-secondary">Annulla</a>
</form>

<script>
	document.getElementById('sel-prof')?.addEventListener('change', e => {
		const url = new URL(window.location.href);
		url.searchParams.set('p', e.target.value);
		window.location.href = url.toString();
	});
</script>
{% endblock %}